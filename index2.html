<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js">
			
		</script>
		
		<script type="text/javascript">
			$(function(){   
			    $("#btn").bind("click",{btn:$("#btn")},function(evdata){      
			         $.ajax({      
			                type:"POST",      
			                dataType:"json",      
			                url:"data.php",      
			                timeout:40000,     //ajax请求超时时间80秒      
			                data:{time:"80"}, //40秒后无论结果服务器都返回数据      
			                success:function(data,textStatus){      
			                    //从服务器得到数据，显示数据并继续查询      
			                    if(data.success=="1"){  
			                     var length=data.text.length;
			                     var sortLength=length/2;
			                     for(var i=0;i<sortLength;i++){
			                     	// alert(i);
			                     	$('#msg').append('[内容]'+data.text[i*2]);
			                     	$('#time').append('[时间]'+data.text[i*2+1]);
			                     }    
			                     // $("#msg").append("<br>[有数据]"+data.text.length);      
			                     evdata.data.btn.click();      
			                    }      
			                 //未从服务器得到数据，继续查询      
			                    if(data.success=="0"){      
			                    $("#msg").append("<br>[无数据]");      
			                    evdata.data.btn.click();      
			                    }      
			                },      
			             //Ajax请求超时，继续查询      
			             error:function(XMLHttpRequest,textStatus,errorThrown){      
			                     if(textStatus=="timeout"){      
			                         $("#msg").append("<br>[超时]");      
			                         evdata.data.btn.click();      
			                     }      
			             }      
			                      
			            });      
			    });      
			    
			  $('#btn-test').click(function(e){
			  	
			  		$.ajax({      
			                type:"POST",      
			                dataType:"json",      
			                url:"test-Data.php",   
			                data:{time:"80"}
			            });   
			  })    
			});    
		</script>
	</head>
	<body>
		<div id="msg"></div> <h2 id='time'></h2>    
		<input id="btn" type="button" value="测试" />  
		<input id="btn-test" type="button" value="测试数据填充" />  
		  
	</body>
</html>
